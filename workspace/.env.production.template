# TrustLayer Production Environment Variables
# Copy this file and fill in real values (DO NOT COMMIT SECRETS)

# ========================================
# CORE APPLICATION
# ========================================

NODE_ENV=production
PORT=3001

# ========================================
# DATABASE
# ========================================

# PostgreSQL connection string (provided by Render automatically)
# Format: postgresql://username:password@host:port/database?sslmode=require
DATABASE_URL=postgresql://trustlayer_user:PLACEHOLDER_PASSWORD@dpg-xxxxx.oregon-postgres.render.com/trustlayer

# ========================================
# OAUTH - GITHUB (REQUIRED)
# ========================================

# From: https://github.com/settings/developers
# Create OAuth App with callback: https://your-api-url.onrender.com/api/oauth/github/callback
GITHUB_CLIENT_ID=Iv1.xxxxxxxxxxxxxxxx
GITHUB_CLIENT_SECRET=gh_secret_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ========================================
# OAUTH - LINKEDIN (OPTIONAL)
# ========================================

# From: https://www.linkedin.com/developers/apps
# Only needed if ENABLE_LINKEDIN_OAUTH=true
LINKEDIN_CLIENT_ID=your_linkedin_client_id
LINKEDIN_CLIENT_SECRET=your_linkedin_client_secret

# ========================================
# OAUTH CONFIGURATION
# ========================================

# Base URL for OAuth callbacks (must match OAuth app settings)
# Example: https://trustlayer-api.onrender.com
OAUTH_CALLBACK_BASE_URL=https://your-api-url.onrender.com

# ========================================
# SECURITY
# ========================================

# JWT secret for signing credentials (GENERATE NEW FOR PRODUCTION)
# Generate with: openssl rand -base64 32
JWT_SECRET=REPLACE_WITH_SECURE_RANDOM_STRING_32_CHARS_MIN

# ========================================
# FEATURE FLAGS
# ========================================

# Set to 'true' to enable test mode (simulated verifications)
# PRODUCTION: Must be 'false'
TEST_MODE=false

# Set to 'true' to enable LinkedIn OAuth
# PRODUCTION: Start with 'false', enable after GitHub OAuth validated
ENABLE_LINKEDIN_OAUTH=false

# ========================================
# RATE LIMITING (ANTI-ABUSE)
# ========================================

# Onboarding rate limit (creating new contractors)
# Conservative: 10 attempts per 15 minutes
RATE_LIMIT_ONBOARD_MAX=10
RATE_LIMIT_ONBOARD_WINDOW_MIN=15

# Verification rate limit (identity, GitHub, LinkedIn checks)
# Moderate: 50 attempts per 15 minutes
RATE_LIMIT_VERIFY_MAX=50
RATE_LIMIT_VERIFY_WINDOW_MIN=15

# Credential operations (issue, revoke, verify)
# Conservative: 20 attempts per 15 minutes
RATE_LIMIT_CREDENTIAL_MAX=20
RATE_LIMIT_CREDENTIAL_WINDOW_MIN=15

# ========================================
# OPTIONAL: EXTERNAL INTEGRATIONS
# ========================================

# Checkr API (Background checks) - Not required for MVP
# CHECKR_API_KEY=your_checkr_api_key

# SendGrid API (Email notifications) - Not required for MVP
# SENDGRID_API_KEY=your_sendgrid_api_key
# FROM_EMAIL=noreply@trustlayer.com

# Sentry (Error monitoring) - Recommended for production
# SENTRY_DSN=https://xxxxx@sentry.io/xxxxx

# ========================================
# NOTES FOR DEPLOYMENT
# ========================================

# 1. Copy this file to .env.production (local) or set vars in Render dashboard
# 2. Replace ALL placeholder values with real credentials
# 3. Generate new JWT_SECRET (never use default)
# 4. Start with TEST_MODE=false, ENABLE_LINKEDIN_OAUTH=false
# 5. Verify DATABASE_URL uses SSL (sslmode=require)
# 6. Keep OAUTH_CALLBACK_BASE_URL synced with OAuth app settings
# 7. Adjust rate limits based on actual traffic patterns

# ========================================
# SECURITY CHECKLIST
# ========================================

# [ ] JWT_SECRET is 32+ characters of cryptographically random data
# [ ] All OAuth client secrets are from production OAuth apps (not dev apps)
# [ ] DATABASE_URL includes sslmode=require
# [ ] TEST_MODE=false
# [ ] OAUTH_CALLBACK_BASE_URL matches exactly what's in GitHub OAuth app
# [ ] No secrets committed to git (.env.production in .gitignore)
# [ ] Rate limits configured (not disabled)
